import from: wasi_unstable
  fd_write fd iovec iovec_len num_written

add a b =>
  ~a
  ~b
  !i32.add

store addr value =>
  ~addr
  ~value
  !i32.store

load addr =>
  ~addr
  !i32.load

next ptr => add ~ptr 4

drop => !drop

string_len string => load string
string_ptr string => next string

string_store addr string =
  store addr (string_ptr string)
  store (next addr) (string_len string)
  ()

stdout => 1
iovec => 100
written => 20
string_store iovec "hello catac!\n"
drop

fd_write stdout iovec 1 written
drop