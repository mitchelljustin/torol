import from: wasi_unstable
  fd_write fd iovec iovec_len num_written

(a + b) =>
  ~a
  ~b
  !i32.add

(a - b) =>
  ~a
  ~b
  !i32.sub

store addr value =>
  ~addr
  ~value
  !i32.store

(addr <- value) =>
  store ~addr ~value

load addr =>
  ~addr
  !i32.load

next ptr => ~ptr + 4

drop => !drop

string.len string => load string
string.ptr string => next string

string.store addr string =
  addr <- string.ptr string
  (next addr) <- string.len string
  ()

print message =
  stdout = 1
  iovec = 0
  string.store iovec message
  written = iovec + 8
  _ = fd_write stdout iovec 1 written
  ()

print "hello catac!\n"